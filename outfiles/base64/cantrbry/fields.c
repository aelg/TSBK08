I2lmbmRlZiBsaW50CnN0YXRpYyBjaGFyIFJjc19JZFtdID0KICAgICIkSWQ6IGZpZWxkcy5jLHYg
MS43IDE5OTQvMDEvMDYgMDU6MjY6MzcgZ2VvZmYgRXhwICQiOwojZW5kaWYKCi8qCiAqICRMb2c6
IGZpZWxkcy5jLHYgJAogKiBSZXZpc2lvbiAxLjcgIDE5OTQvMDEvMDYgIDA1OjI2OjM3ICBnZW9m
ZgogKiBHZXQgcmlkIG9mIGFsbCByZWZlcmVuY2VzIHRvIFN5c3RlbSBWIHN0cmluZyByb3V0aW5l
cywgZm9yIHBvcnRhYmlsaXR5CiAqIChzaWdoKS4KICoKICogUmV2aXNpb24gMS42ICAxOTk0LzAx
LzA1ICAyMDoxMzo0MyAgZ2VvZmYKICogQWRkIHRoZSBtYXhmIHBhcmFtZXRlcgogKgogKiBSZXZp
c2lvbiAxLjUgIDE5OTQvMDEvMDQgIDAyOjQwOjIxICBnZW9mZgogKiBNYWtlIHRoZSBpbmNyZW1l
bnRzIHNldHRhYmxlIChmaWVsZF9saW5lX2luYyBhbmQgZmllbGRfZmllbGRfaW5jKS4KICogQWRk
IHN1cHBvcnQgZm9yIHRoZSBGTERfTk9TSFJJTksgZmxhZy4KICoKICogUmV2aXNpb24gMS40ICAx
OTkzLzA5LzI3ICAxNzo0ODowMiAgZ2VvZmYKICogRml4IHNvbWUgbGludCBjb21wbGFpbnRzIGFu
ZCBzb21lIHBhcmVudGhlc2l6YXRpb24gZXJyb3JzLgogKgogKiBSZXZpc2lvbiAxLjMgIDE5OTMv
MDkvMDkgIDAxOjExOjExICBnZW9mZgogKiBBZGQgYSByZXR1cm4gdmFsdWUgdG8gZmllbGR3cml0
ZS4gIEFkZCBzdXBwb3J0IGZvciBiYWNrcXVvdGVzIGFuZCBmb3IKICogdW5zdHJpcHBlZCBiYWNr
c2xhc2hlcy4KICoKICogUmV2aXNpb24gMS4yICAxOTkzLzA4LzI2ICAwMDowMjo1MCAgZ2VvZmYK
ICogRml4IGEgc3R1cGlkIG51bGwtcG9pbnRlciBidWcKICoKICogUmV2aXNpb24gMS4xICAxOTkz
LzA4LzI1ICAyMTozMjowNSAgZ2VvZmYKICogSW5pdGlhbCByZXZpc2lvbgogKgogKi8KCiNpbmNs
dWRlIDxzdGRpby5oPgojaW5jbHVkZSAiY29uZmlnLmgiCiNpbmNsdWRlICJmaWVsZHMuaCIKCmZp
ZWxkX3QgKglmaWVsZHJlYWQgUCAoKEZJTEUgKiBmaWxlLCBjaGFyICogZGVsaW1zLAoJCQkJICBp
bnQgZmxhZ3MsIGludCBtYXhmKSk7CgkJCQkvKiBSZWFkIGEgbGluZSB3aXRoIGZpZWxkcyBmcm9t
IGEgZmlsZSAqLwpmaWVsZF90ICoJZmllbGRtYWtlIFAgKChjaGFyICogbGluZSwgaW50IGFsbG9j
YXRlZCwgY2hhciAqIGRlbGltcywKCQkJCSAgaW50IGZsYWdzLCBpbnQgbWF4ZikpOwoJCQkJLyog
TWFrZSBhIGZpZWxkIHN0cnVjdHVyZSBmcm9tIGEgbGluZSAqLwpzdGF0aWMgZmllbGRfdCAqIGZp
ZWxkcGFyc2UgUCAoKGZpZWxkX3QgKiBmaWVsZHAsIGNoYXIgKiBsaW5lLCBjaGFyICogZGVsaW1z
LAoJCQkJICBpbnQgZmxhZ3MsIGludCBtYXhmKSk7CgkJCQkvKiBQYXJzZSB0aGUgZmllbGRzIGlu
IGEgbGluZSAqLwpzdGF0aWMgaW50CWZpZWxkYmFja2NoIFAgKChjaGFyICogc3RyLCBjaGFyICoq
IG91dCwgaW50IHN0cmlwKSk7CgkJCQkvKiBQcm9jZXNzIGJhY2tzbGFzaCBzZXF1ZW5jZXMgKi8K
aW50CQlmaWVsZHdyaXRlIFAgKChGSUxFICogZmlsZSwgZmllbGRfdCAqIGZpZWxkcCwgaW50IGRl
bGltKSk7CgkJCQkvKiBXcml0ZSBhIGxpbmUgd2l0aCBmaWVsZHMgdG8gYSBmaWxlICovCnZvaWQJ
CWZpZWxkZnJlZSBQICgoZmllbGRfdCAqIGZpZWxkcCkpOwoJCQkJLyogRnJlZSBhIGZpZWxkIHJl
dHVybmVkIGJ5IGZpZWxkcmVhZCAqLwoKdW5zaWduZWQgaW50CWZpZWxkX2ZpZWxkX2luYyA9IDIw
OyAvKiBJbmNyZW1lbnQgdG8gaW5jcmVhc2UgIyBmaWVsZHMgYnkgKi8KdW5zaWduZWQgaW50CWZp
ZWxkX2xpbmVfaW5jID0gNTEyOyAvKiBJbmNyIHRvIGluY3JlYXNlIGxpbmUgbGVuZ3RoIGJ5ICov
CgojaWZuZGVmIFVTRwojZGVmaW5lIHN0cmNocglpbmRleAojZW5kaWYgLyogVVNHICovCgpleHRl
cm4gdm9pZAlmcmVlICgpOwpleHRlcm4gY2hhciAqCW1hbGxvYyAoKTsKZXh0ZXJuIGNoYXIgKgly
ZWFsbG9jICgpOwpleHRlcm4gY2hhciAqCXN0cmNociAoKTsKZXh0ZXJuIGludAlzdHJsZW4gKCk7
CgovKgogKiBSZWFkIG9uZSBsaW5lIG9mIHRoZSBnaXZlbiBmaWxlIGludG8gYSBidWZmZXIsIGJy
ZWFrIGl0IHVwIGludG8KICogZmllbGRzLCBhbmQgcmV0dXJuIHRoZW0gdG8gdGhlIGNhbGxlci4g
IFRoZSBmaWVsZF90IHN0cnVjdHVyZQogKiByZXR1cm5lZCBtdXN0IGV2ZW50dWFsbHkgYmUgZnJl
ZWQgd2l0aCBmaWVsZGZyZWUuCiAqLwpmaWVsZF90ICogZmllbGRyZWFkIChmaWxlLCBkZWxpbXMs
IGZsYWdzLCBtYXhmKQogICAgRklMRSAqCQlmaWxlOwkvKiBGaWxlIHRvIHJlYWQgbGluZXMgZnJv
bSAqLwogICAgY2hhciAqCQlkZWxpbXM7CS8qIENoYXJhY3RlcnMgdG8gdXNlIGZvciBmaWVsZCBk
ZWxpbWl0ZXJzICovCiAgICBpbnQJCQlmbGFnczsJLyogT3B0aW9uIGZsYWdzOyAgc2VlIGZpZWxk
cy5oICovCiAgICBpbnQJCQltYXhmOwkvKiBNYXhpbXVtIG51bWJlciBvZiBmaWVsZHMgdG8gcGFy
c2UgKi8KICAgIHsKICAgIHJlZ2lzdGVyIGNoYXIgKglsaW5lYnVmOyAvKiBCdWZmZXIgdG8gaG9s
ZCB0aGUgbGluZSByZWFkIGluICovCiAgICBpbnQJCQlsaW5lbWF4OyAvKiBNYXhpbXVtIGxpbmUg
YnVmZmVyIHNpemUgKi8KICAgIGludAkJCWxpbmVzaXplOyAvKiBDdXJyZW50IGxpbmUgYnVmZmVy
IHNpemUgKi8KCiAgICBsaW5lYnVmID0gKGNoYXIgKikgbWFsbG9jIChmaWVsZF9saW5lX2luYyk7
CiAgICBpZiAobGluZWJ1ZiA9PSBOVUxMKQoJcmV0dXJuIE5VTEw7CiAgICBsaW5lbWF4ID0gZmll
bGRfbGluZV9pbmM7CiAgICBsaW5lc2l6ZSA9IDA7CiAgICAvKgogICAgICogUmVhZCBpbiB0aGUg
bGluZS4KICAgICAqLwogICAgd2hpbGUgKGZnZXRzICgmbGluZWJ1ZltsaW5lc2l6ZV0sIGxpbmVt
YXggLSBsaW5lc2l6ZSwgZmlsZSkKICAgICAgIT0gTlVMTCkKCXsKCWxpbmVzaXplICs9IHN0cmxl
biAoJmxpbmVidWZbbGluZXNpemVdKTsKCWlmIChsaW5lYnVmW2xpbmVzaXplIC0gMV0gPT0gJ1xu
JykKCSAgICBicmVhazsKCWVsc2UKCSAgICB7CgkgICAgbGluZW1heCArPSBmaWVsZF9saW5lX2lu
YzsKCSAgICBsaW5lYnVmID0gKGNoYXIgKikgcmVhbGxvYyAobGluZWJ1ZiwgbGluZW1heCk7Cgkg
ICAgaWYgKGxpbmVidWYgPT0gTlVMTCkKCQlyZXR1cm4gTlVMTDsKCSAgICB9Cgl9CiAgICBpZiAo
bGluZXNpemUgPT0gMCkKCXsKCWZyZWUgKGxpbmVidWYpOwoJcmV0dXJuIE5VTEw7Cgl9CiAgICBy
ZXR1cm4gZmllbGRtYWtlIChsaW5lYnVmLCAxLCBkZWxpbXMsIGZsYWdzLCBtYXhmKTsKICAgIH0K
CmZpZWxkX3QgKiBmaWVsZG1ha2UgKGxpbmUsIGFsbG9jYXRlZCwgZGVsaW1zLCBmbGFncywgbWF4
ZikKICAgIGNoYXIgKgkJbGluZTsJLyogTGluZSB0byBtYWtlIGludG8gYSBmaWVsZCBzdHJ1Y3R1
cmUgKi8KICAgIGludAkJCWFsbG9jYXRlZDsgLyogTlogaWYgbGluZSBhbGxvY2F0ZWQgd2l0aCBt
YWxsb2MgKi8KICAgIGNoYXIgKgkJZGVsaW1zOwkvKiBDaGFyYWN0ZXJzIHRvIHVzZSBmb3IgZmll
bGQgZGVsaW1pdGVycyAqLwogICAgaW50CQkJZmxhZ3M7CS8qIE9wdGlvbiBmbGFnczsgIHNlZSBm
aWVsZHMuaCAqLwogICAgaW50CQkJbWF4ZjsJLyogTWF4aW11bSBudW1iZXIgb2YgZmllbGRzIHRv
IHBhcnNlICovCiAgICB7CiAgICByZWdpc3RlciBmaWVsZF90ICoJZmllbGRwOwkvKiBTdHJ1Y3R1
cmUgZGVzY3JpYmluZyB0aGUgZmllbGRzICovCiAgICBpbnQJCQlsaW5lc2l6ZTsgLyogQ3VycmVu
dCBsaW5lIGJ1ZmZlciBzaXplICovCgogICAgZmllbGRwID0gKGZpZWxkX3QgKikgbWFsbG9jIChz
aXplb2YgKGZpZWxkX3QpKTsKICAgIGlmIChmaWVsZHAgPT0gTlVMTCkKCXJldHVybiBOVUxMOwog
ICAgZmllbGRwLT5uZmllbGRzID0gMDsKICAgIGZpZWxkcC0+bGluZWJ1ZiA9IGFsbG9jYXRlZCA/
IGxpbmUgOiBOVUxMOwogICAgZmllbGRwLT5maWVsZHMgPSBOVUxMOwogICAgZmllbGRwLT5oYWRu
bCA9IDA7CiAgICBsaW5lc2l6ZSA9IHN0cmxlbiAobGluZSk7CiAgICBpZiAobGluZVtsaW5lc2l6
ZSAtIDFdID09ICdcbicpCgl7CglsaW5lWy0tbGluZXNpemVdID0gJ1wwJzsKCWZpZWxkcC0+aGFk
bmwgPSAxOwoJfQogICAgLyoKICAgICAqIFNocmluayB0aGUgbGluZSBidWZmZXIgaWYgbmVjZXNz
YXJ5LgogICAgICovCiAgICBpZiAoYWxsb2NhdGVkICAmJiAgKGZsYWdzICYgRkxEX05PU0hSSU5L
KSA9PSAwKQoJewoJbGluZSA9IGZpZWxkcC0+bGluZWJ1ZiA9CgkgIChjaGFyICopIHJlYWxsb2Mg
KGZpZWxkcC0+bGluZWJ1ZiwgbGluZXNpemUgKyAxKTsKCWlmIChmaWVsZHAtPmxpbmVidWYgPT0g
TlVMTCkKCSAgICB7CgkgICAgZmllbGRmcmVlIChmaWVsZHApOwoJICAgIHJldHVybiBOVUxMOwoJ
ICAgIH0KCX0KICAgIHJldHVybiBmaWVsZHBhcnNlIChmaWVsZHAsIGxpbmUsIGRlbGltcywgZmxh
Z3MsIG1heGYpOwogICAgfQoKc3RhdGljIGZpZWxkX3QgKiBmaWVsZHBhcnNlIChmaWVsZHAsIGxp
bmUsIGRlbGltcywgZmxhZ3MsIG1heGYpCiAgICByZWdpc3RlciBmaWVsZF90ICoJZmllbGRwOwkv
KiBGaWVsZCBzdHJ1Y3R1cmUgdG8gcGFyc2UgaW50byAqLwogICAgcmVnaXN0ZXIgY2hhciAqCWxp
bmU7CS8qIExpbmUgdG8gYmUgcGFyc2VkICovCiAgICBjaGFyICoJCWRlbGltczsJLyogQ2hhcmFj
dGVycyB0byB1c2UgZm9yIGZpZWxkIGRlbGltaXRlcnMgKi8KICAgIGludAkJCWZsYWdzOwkvKiBP
cHRpb24gZmxhZ3M7ICBzZWUgZmllbGRzLmggKi8KICAgIGludAkJCW1heGY7CS8qIE1heGltdW0g
bnVtYmVyIG9mIGZpZWxkcyB0byBwYXJzZSAqLwogICAgewogICAgaW50CQkJZmllbGRtYXg7IC8q
IE1heCBzaXplIG9mIGZpZWxkcyBhcnJheSAqLwogICAgY2hhciAqCQlsaW5lb3V0OyAvKiBXaGVy
ZSB0byBzdG9yZSB4bGF0ZWQgY2hhciBpbiBsaW5lICovCiAgICBjaGFyCQlxdW90ZTsJLyogUXVv
dGUgY2hhcmFjdGVyIGluIHVzZSAqLwoKICAgIGZpZWxkcC0+bmZpZWxkcyA9IDA7CiAgICBmaWVs
ZG1heCA9CiAgICAgIChtYXhmICE9IDAgICYmICBtYXhmIDwgZmllbGRfZmllbGRfaW5jKSA/IG1h
eGYgKyAyIDogZmllbGRfZmllbGRfaW5jOwogICAgZmllbGRwLT5maWVsZHMgPSAoY2hhciAqKikg
bWFsbG9jIChmaWVsZG1heCAqIHNpemVvZiAoY2hhciAqKSk7CiAgICBpZiAoZmllbGRwLT5maWVs
ZHMgPT0gTlVMTCkKCXsKCWZpZWxkZnJlZSAoZmllbGRwKTsKCXJldHVybiBOVUxMOwoJfQogICAg
aWYgKChmbGFncwoJJiAoRkxEX1NIUVVPVEVTIHwgRkxEX1NOR0xRVU9URVMgfCBGTERfQkFDS1FV
T1RFUyB8IEZMRF9EQkxRVU9URVMpKQogICAgICA9PSBGTERfU0hRVU9URVMpCglmbGFncyB8PSBG
TERfU05HTFFVT1RFUyB8IEZMRF9CQUNLUVVPVEVTIHwgRkxEX0RCTFFVT1RFUzsKICAgIHdoaWxl
ICgxKQoJewoJaWYgKGZsYWdzICYgRkxEX1JVTlMpCgkgICAgewoJICAgIHdoaWxlICgqbGluZSAh
PSAnXDAnICAmJiAgc3RyY2hyIChkZWxpbXMsICpsaW5lKSAhPSBOVUxMKQoJCWxpbmUrKzsJCQkv
KiBTa2lwIHJ1bnMgb2YgZGVsaW1pdGVycyAqLwoJICAgIGlmICgqbGluZSA9PSAnXDAnKQoJCWJy
ZWFrOwoJICAgIH0KCWZpZWxkcC0+ZmllbGRzW2ZpZWxkcC0+bmZpZWxkc10gPSBsaW5lb3V0ID0g
bGluZTsKCS8qCgkgKiBTa2lwIHRvIHRoZSBuZXh0IGRlbGltaXRlci4gIEF0IHRoZSBlbmQgb2Yg
c2tpcHBpbmcsICJsaW5lIiB3aWxsCgkgKiBwb2ludCB0byBlaXRoZXIgYSBkZWxpbWl0ZXIgb3Ig
YSBudWxsIGJ5dGUuCgkgKi8KCWlmIChmbGFncwoJICAmIChGTERfU0hRVU9URVMgfCBGTERfU05H
TFFVT1RFUyB8IEZMRF9CQUNLUVVPVEVTCgkgICAgfCBGTERfREJMUVVPVEVTIHwgRkxEX0JBQ0tT
TEFTSCkpCgkgICAgewoJICAgIHdoaWxlICgqbGluZSAhPSAnXDAnKQoJCXsKCQlpZiAoc3RyY2hy
IChkZWxpbXMsICpsaW5lKSAhPSBOVUxMKQoJCSAgICBicmVhazsKCQllbHNlIGlmICgoKGZsYWdz
ICYgRkxEX1NOR0xRVU9URVMpICAmJiAgKmxpbmUgPT0gJ1wnJykKCQkgIHx8ICAoKGZsYWdzICYg
RkxEX0JBQ0tRVU9URVMpICAmJiAgKmxpbmUgPT0gJ2AnKQoJCSAgfHwgICgoZmxhZ3MgJiBGTERf
REJMUVVPVEVTKSAgJiYgICpsaW5lID09ICciJykpCgkJICAgIHsKCQkgICAgaWYgKChmbGFncyAm
IEZMRF9TSFFVT1RFUykgPT0gMAoJCSAgICAgICYmICBsaW5lICE9IGZpZWxkcC0+ZmllbGRzW2Zp
ZWxkcC0+bmZpZWxkc10pCgkJCXF1b3RlID0gJ1wwJzsKCQkgICAgZWxzZQoJCQlxdW90ZSA9ICps
aW5lOwoJCSAgICB9CgkJZWxzZQoJCSAgICBxdW90ZSA9ICdcMCc7CgkJaWYgKHF1b3RlID09ICdc
MCcpCgkJICAgIHsKCQkgICAgaWYgKCpsaW5lID09ICdcXCcgICYmICAoZmxhZ3MgJiBGTERfQkFD
S1NMQVNIKSkKCQkJewoJCQlsaW5lKys7CgkJCWlmICgqbGluZSA9PSAnXDAnKQoJCQkgICAgYnJl
YWs7CgkJCWxpbmUgKz0gZmllbGRiYWNrY2ggKGxpbmUsICZsaW5lb3V0LAoJCQkgIGZsYWdzICYg
RkxEX1NUUklQUVVPVEVTKTsKCQkJfQoJCSAgICBlbHNlCgkJCSpsaW5lb3V0KysgPSAqbGluZSsr
OwoJCSAgICB9CgkJZWxzZQoJCSAgICB7CgkJICAgIC8qIFByb2Nlc3MgcXVvdGVkIHN0cmluZyAq
LwoJCSAgICBpZiAoKGZsYWdzICYgRkxEX1NUUklQUVVPVEVTKSA9PSAwKQoJCQkqbGluZW91dCsr
ID0gcXVvdGU7CgkJICAgICsrbGluZTsKCQkgICAgd2hpbGUgKCpsaW5lICE9ICdcMCcpCgkJCXsK
CQkJaWYgKCpsaW5lID09IHF1b3RlKQoJCQkgICAgewoJCQkgICAgaWYgKChmbGFncyAmIEZMRF9T
VFJJUFFVT1RFUykgPT0gMCkKCQkJCSpsaW5lb3V0KysgPSBxdW90ZTsKCQkJICAgIGxpbmUrKzsJ
CS8qIEdvIG9uIHBhc3QgcXVvdGUgKi8KCQkJICAgIGlmICgoZmxhZ3MgJiBGTERfU0hRVU9URVMp
ID09IDApCgkJCQl7CgkJCQl3aGlsZSAoKmxpbmUgIT0gJ1wwJwoJCQkJICAmJiAgc3RyY2hyIChk
ZWxpbXMsICpsaW5lKSA9PSBOVUxMKQoJCQkJICAgIGxpbmUrKzsJLyogU2tpcCB0byBkZWxpbWl0
ZXIgKi8KCQkJCX0KCQkJICAgIGJyZWFrOwoJCQkgICAgfQoJCQllbHNlIGlmICgqbGluZSA9PSAn
XFwnKQoJCQkgICAgewoJCQkgICAgaWYgKGZsYWdzICYgRkxEX0JBQ0tTTEFTSCkKCQkJCXsKCQkJ
CWxpbmUrKzsKCQkJCWlmICgqbGluZSA9PSAnXDAnKQoJCQkJICAgIGJyZWFrOwoJCQkJZWxzZQoJ
CQkJICAgIGxpbmUgKz0gZmllbGRiYWNrY2ggKGxpbmUsICZsaW5lb3V0LAoJCQkJICAgICAgZmxh
Z3MgJiBGTERfU1RSSVBRVU9URVMpOwoJCQkJfQoJCQkgICAgZWxzZQoJCQkJewoJCQkJKmxpbmVv
dXQrKyA9ICdcXCc7CgkJCQlpZiAoKisrbGluZSA9PSAnXDAnKQoJCQkJICAgIGJyZWFrOwoJCQkJ
KmxpbmVvdXQrKyA9ICpsaW5lOwoJCQkJfQoJCQkgICAgfQoJCQllbHNlCgkJCSAgICAqbGluZW91
dCsrID0gKmxpbmUrKzsKCQkJfQoJCSAgICB9CgkJfQoJICAgIH0KCWVsc2UKCSAgICB7CgkgICAg
d2hpbGUgKCpsaW5lICE9ICdcMCcgICYmICBzdHJjaHIgKGRlbGltcywgKmxpbmUpID09IE5VTEwp
CgkJbGluZSsrOwkJCS8qIFNraXAgdG8gZGVsaW1pdGVyICovCgkgICAgbGluZW91dCA9IGxpbmU7
CgkgICAgfQoJZmllbGRwLT5uZmllbGRzKys7CglpZiAoKmxpbmUrKyA9PSAnXDAnKQoJICAgIGJy
ZWFrOwoJaWYgKG1heGYgIT0gMCAgJiYgIGZpZWxkcC0+bmZpZWxkcyA+IG1heGYpCgkgICAgYnJl
YWs7CgkqbGluZW91dCA9ICdcMCc7CglpZiAoZmllbGRwLT5uZmllbGRzID49IGZpZWxkbWF4KQoJ
ICAgIHsKCSAgICBmaWVsZG1heCArPSBmaWVsZF9maWVsZF9pbmM7CgkgICAgZmllbGRwLT5maWVs
ZHMgPQoJICAgICAgKGNoYXIgKiopIHJlYWxsb2MgKGZpZWxkcC0+ZmllbGRzLCBmaWVsZG1heCAq
IHNpemVvZiAoY2hhciAqKSk7CgkgICAgaWYgKGZpZWxkcC0+ZmllbGRzID09IE5VTEwpCgkJewoJ
CWZpZWxkZnJlZSAoZmllbGRwKTsKCQlyZXR1cm4gTlVMTDsKCQl9CgkgICAgfQoJfQogICAgLyoK
ICAgICAqIFNocmluayB0aGUgZmllbGQgcG9pbnRlcnMgYW5kIHJldHVybiB0aGUgZmllbGQgc3Ry
dWN0dXJlLgogICAgICovCiAgICBpZiAoKGZsYWdzICYgRkxEX05PU0hSSU5LKSA9PSAwICAmJiAg
ZmllbGRwLT5uZmllbGRzID49IGZpZWxkbWF4KQoJewoJZmllbGRwLT5maWVsZHMgPSAoY2hhciAq
KikgcmVhbGxvYyAoZmllbGRwLT5maWVsZHMsCgkgIChmaWVsZHAtPm5maWVsZHMgKyAxKSAqIHNp
emVvZiAoY2hhciAqKSk7CglpZiAoZmllbGRwLT5maWVsZHMgPT0gTlVMTCkKCSAgICB7CgkgICAg
ZmllbGRmcmVlIChmaWVsZHApOwoJICAgIHJldHVybiBOVUxMOwoJICAgIH0KCX0KICAgIGZpZWxk
cC0+ZmllbGRzW2ZpZWxkcC0+bmZpZWxkc10gPSBOVUxMOwogICAgcmV0dXJuIGZpZWxkcDsKICAg
IH0KCnN0YXRpYyBpbnQgZmllbGRiYWNrY2ggKHN0ciwgb3V0LCBzdHJpcCkKICAgIHJlZ2lzdGVy
IGNoYXIgKglzdHI7CQkvKiBGaXJzdCBjaGFyIG9mIGJhY2tzbGFzaCBzZXF1ZW5jZSAqLwogICAg
cmVnaXN0ZXIgY2hhciAqKglvdXQ7CQkvKiBXaGVyZSB0byBzdG9yZSByZXN1bHQgKi8KICAgIGlu
dAkJCXN0cmlwOwkJLyogTlogdG8gY29udmVydCB0aGUgc2VxdWVuY2UgKi8KICAgIHsKICAgIHJl
Z2lzdGVyIGludAljaDsJCS8qIENoYXJhY3RlciBiZWluZyBkZXZlbG9wZWQgKi8KICAgIGNoYXIg
KgkJb3JpZ3N0cjsJLyogT3JpZ2luYWwgdmFsdWUgb2Ygc3RyICovCgogICAgaWYgKCFzdHJpcCkK
CXsKCSooKm91dCkrKyA9ICdcXCc7CglpZiAoKnN0ciAhPSAneCcgICYmICAqc3RyICE9ICdYJyAg
JiYgICgqc3RyIDwgJzAnICB8fCAgKnN0ciA+ICc3JykpCgkgICAgewoJICAgICooKm91dCkrKyA9
ICpzdHI7CgkgICAgcmV0dXJuICpzdHIgIT0gJ1wwJzsKCSAgICB9Cgl9CiAgICBzd2l0Y2ggKCpz
dHIpCgl7CgljYXNlICdcMCc6CgkgICAgKigqb3V0KSsrID0gJ1wwJzsKCSAgICByZXR1cm4gMDsK
CWNhc2UgJ2EnOgoJICAgICooKm91dCkrKyA9ICdcMDA3JzsKCSAgICByZXR1cm4gMTsKCWNhc2Ug
J2InOgoJICAgICooKm91dCkrKyA9ICdcYic7CgkgICAgcmV0dXJuIDE7CgljYXNlICdmJzoKCSAg
ICAqKCpvdXQpKysgPSAnXGYnOwoJICAgIHJldHVybiAxOwoJY2FzZSAnbic6CgkgICAgKigqb3V0
KSsrID0gJ1xuJzsKCSAgICByZXR1cm4gMTsKCWNhc2UgJ3InOgoJICAgICooKm91dCkrKyA9ICdc
cic7CgkgICAgcmV0dXJuIDE7CgljYXNlICd2JzoKCSAgICAqKCpvdXQpKysgPSAnXHYnOwoJICAg
IHJldHVybiAxOwoJY2FzZSAnWCc6CgljYXNlICd4JzoKCSAgICAvKiBIZXhhZGVjaW1hbCBzZXF1
ZW5jZSAqLwoJICAgIG9yaWdzdHIgPSBzdHIrKzsKCSAgICBjaCA9IDA7CgkgICAgaWYgKCpzdHIg
Pj0gJzAnICAmJiAgKnN0ciA8PSAnOScpCgkJY2ggPSAqc3RyKysgLSAnMCc7CgkgICAgZWxzZSBp
ZiAoKnN0ciA+PSAnYScgICYmICAqc3RyIDw9ICdmJykKCQljaCA9ICpzdHIrKyAtICdhJyArIDB4
YTsKCSAgICBlbHNlIGlmICgqc3RyID49ICdBJyAgJiYgICpzdHIgPD0gJ0YnKQoJCWNoID0gKnN0
cisrIC0gJ0EnICsgMHhhOwoJICAgIGlmICgqc3RyID49ICcwJyAgJiYgICpzdHIgPD0gJzknKQoJ
CWNoID0gKGNoIDw8IDQpIHwgKCpzdHIrKyAtICcwJyk7CgkgICAgZWxzZSBpZiAoKnN0ciA+PSAn
YScgICYmICAqc3RyIDw9ICdmJykKCQljaCA9IChjaCA8PCA0KSB8ICgqc3RyKysgLSAnYScgKyAw
eGEpOwoJICAgIGVsc2UgaWYgKCpzdHIgPj0gJ0EnICAmJiAgKnN0ciA8PSAnRicpCgkJY2ggPSAo
Y2ggPDwgNCkgfCAoKnN0cisrIC0gJ0EnICsgMHhhKTsKCSAgICBicmVhazsKCWNhc2UgJzAnOgoJ
Y2FzZSAnMSc6CgljYXNlICcyJzoKCWNhc2UgJzMnOgoJY2FzZSAnNCc6CgljYXNlICc1JzoKCWNh
c2UgJzYnOgoJY2FzZSAnNyc6CgkgICAgLyogT2N0YWwgc2VxdWVuY2UgKi8KCSAgICBvcmlnc3Ry
ID0gc3RyOwoJICAgIGNoID0gKnN0cisrIC0gJzAnOwoJICAgIGlmICgqc3RyID49ICcwJyAgJiYg
ICpzdHIgPD0gJzcnKQoJCWNoID0gKGNoIDw8IDMpIHwgKCpzdHIrKyAtICcwJyk7CgkgICAgaWYg
KCpzdHIgPj0gJzAnICAmJiAgKnN0ciA8PSAnNycpCgkJY2ggPSAoY2ggPDwgMykgfCAoKnN0cisr
IC0gJzAnKTsKCSAgICBicmVhazsKCWRlZmF1bHQ6CgkgICAgKigqb3V0KSsrID0gKnN0cjsKCSAg
ICByZXR1cm4gMTsKCX0KICAgIGlmIChzdHJpcCkKCXsKCSooKm91dCkrKyA9IGNoOwoJcmV0dXJu
IHN0ciAtIG9yaWdzdHI7Cgl9CiAgICBlbHNlCgl7Cglmb3IgKGNoID0gMDsgIG9yaWdzdHIgPCBz
dHI7ICBjaCsrKQoJICAgICooKm91dCkrKyA9ICpvcmlnc3RyKys7CglyZXR1cm4gY2g7Cgl9CiAg
ICB9CgppbnQgZmllbGR3cml0ZSAoZmlsZSwgZmllbGRwLCBkZWxpbSkKICAgIEZJTEUgKgkJZmls
ZTsJLyogRmlsZSB0byB3cml0ZSB0byAqLwogICAgcmVnaXN0ZXIgZmllbGRfdCAqCWZpZWxkcDsJ
LyogRmllbGQgc3RydWN0dXJlIHRvIHdyaXRlICovCiAgICBpbnQJCQlkZWxpbTsJLyogRGVsaW1p
dGVyIHRvIHBsYWNlIGJldHdlZW4gZmllbGRzICovCiAgICB7CiAgICBpbnQJCQllcnJvcjsJLyog
TlogaWYgYW4gZXJyb3Igb2NjdXJzICovCiAgICByZWdpc3RlciBpbnQJZmllbGRubzsgLyogTnVt
YmVyIG9mIGZpZWxkIGJlaW5nIHdyaXR0ZW4gKi8KCiAgICBlcnJvciA9IDA7CiAgICBmb3IgKGZp
ZWxkbm8gPSAwOyAgZmllbGRubyA8IGZpZWxkcC0+bmZpZWxkczsgIGZpZWxkbm8rKykKCXsKCWlm
IChmaWVsZG5vICE9IDApCgkgICAgZXJyb3IgfD0gcHV0YyAoZGVsaW0sIGZpbGUpID09IEVPRjsK
CWVycm9yIHw9IGZwdXRzIChmaWVsZHAtPmZpZWxkc1tmaWVsZG5vXSwgZmlsZSkgPT0gRU9GOwoJ
fQogICAgaWYgKGZpZWxkcC0+aGFkbmwpCgllcnJvciB8PSBwdXRjICgnXG4nLCBmaWxlKSA9PSBF
T0Y7CiAgICByZXR1cm4gZXJyb3I7CiAgICB9Cgp2b2lkIGZpZWxkZnJlZSAoZmllbGRwKQogICAg
cmVnaXN0ZXIgZmllbGRfdCAqCWZpZWxkcDsJLyogRmllbGQgc3RydWN0dXJlIHRvIGZyZWUgKi8K
ICAgIHsKCiAgICBpZiAoZmllbGRwID09IE5VTEwpCglyZXR1cm47CiAgICBpZiAoZmllbGRwLT5s
aW5lYnVmICE9IE5VTEwpCglmcmVlICgoY2hhciAqKSBmaWVsZHAtPmxpbmVidWYpOwogICAgaWYg
KGZpZWxkcC0+ZmllbGRzICE9IE5VTEwpCglmcmVlICgoY2hhciAqKSBmaWVsZHAtPmZpZWxkcyk7
CiAgICBmcmVlICgoY2hhciAqKSBmaWVsZHApOwogICAgH0K=
